# Claude Code v2.1.33 - Changelog

## Multi-Agent Workflows

### Agent teammates en tmux (fix)
- Corregido envío y recepción de mensajes entre agentes en tmux
- Eliminadas advertencias falsas sobre agent teams no disponibles en tu plan

### Nuevos hooks para multi-agent
| Hook | Cuándo se dispara |
|------|-------------------|
| `TeammateIdle` | Un agente teammate termina y queda libre |
| `TaskCompleted` | Una tarea asignada a un agente se completa |

Permiten orquestar flujos multi-agent: detectar teammates disponibles o reaccionar cuando una tarea termina.

### Restricción de sub-agents
- Nuevo: `Task(agent_type)` en frontmatter `tools:` de un agent
- Limita qué tipos de sub-agentes puede spawnear
- Antes cualquier agent podía lanzar cualquier sub-agent

### Memory para agents
- Nuevo campo `memory` en frontmatter de agents
- Scopes: `user`, `project`, `local`
- Memoria persistente entre sesiones, específica por agent

---

## Skills y plugins

### Plugin name en /skills
- `/skills` ahora muestra el nombre del plugin junto a cada skill
- Mejor discoverability cuando tienes muchos skills instalados

---

## Fixes

### Whitespace + thinking block (abort mid-stream)
- **Bug**: Al abortar (Escape) mid-stream, whitespace text + thinking block saltaba la normalización → request inválido a la API
- **Fix**: Normalización correcta antes de enviar el request
- **Nota**: Teníamos un workaround propio en `session-end-summary.sh` que limpiaba whitespace-only blocks del transcript al salir. Con este fix nativo, lo hemos **desactivado** (comentado, disponible si vuelve a fallar). Ver `~/.claude/hooks/session-end-summary.sh`

### Extended thinking interrumpido
- Antes: enviar mensaje mientras el modelo estaba en extended thinking lo interrumpía
- Ahora: espera a que termine la fase de thinking

### API y proxy
| Fix | Detalle |
|-----|---------|
| Proxy 404 | Ya no hace fallback a non-streaming en error 404 |
| Proxy env vars | `settings.json` env vars ahora aplican a WebFetch y HTTP |
| Errores conexión | Muestra causa específica (ECONNREFUSED, SSL) en vez de genérico |

### Otros
- `/resume` ya no muestra XML markup crudo en títulos de sesiones con slash commands
- Errores de managed settings inválidos ahora se muestran (antes silenciosos)

---

## VSCode

| Feature | Detalle |
|---------|---------|
| Remote sessions | OAuth users pueden ver y resumir sesiones desde claude.ai |
| Session picker | Muestra git branch + message count, búsqueda por branch |
| Scroll fix | Corregido under-scrolling al cargar/cambiar sesión |

---

## Impacto en nuestro setup

| Feature | Relevancia |
|---------|-----------|
| Whitespace fix nativo | Desactivado nuestro workaround en `session-end-summary.sh` |
| TeammateIdle / TaskCompleted | Útil si usamos agent teams |
| Agent memory | Complementa MEMORY.md, podría reemplazarlo por agent |
| Task(agent_type) restricción | Control más fino sobre agents custom |
| Plugin name en /skills | Mejor UX con nuestros skills |
| Proxy fixes | Relevante para model-router proxy |
